Found 4908 validated image filenames.
Found 1043 validated image filenames.
Found 1084 validated image filenames.
Downloading data from https://storage.googleapis.com/tensorflow/keras-applications/densenet/densenet121_weights_tf_dim_ordering_tf_kernels_notop.h5
29089792/29084464 [==============================] - 3s 0us/step
------------------------------------------------------------------
Training model  DenseNet121
Epoch 1/30
154/153 [==============================] - 4017s 26s/step - loss: 0.6074 - accuracy: 0.7643 - val_loss: 1.6517 - val_accuracy: 0.6855
Epoch 2/30
154/153 [==============================] - 3987s 26s/step - loss: 0.4520 - accuracy: 0.8293 - val_loss: 0.5769 - val_accuracy: 0.8140
Epoch 3/30
154/153 [==============================] - 3969s 26s/step - loss: 0.4001 - accuracy: 0.8511 - val_loss: 1.3444 - val_accuracy: 0.7152
Epoch 4/30
154/153 [==============================] - 3965s 26s/step - loss: 0.3733 - accuracy: 0.8617 - val_loss: 0.3943 - val_accuracy: 0.8677
Epoch 5/30
154/153 [==============================] - 3967s 26s/step - loss: 0.2900 - accuracy: 0.8945 - val_loss: 0.4017 - val_accuracy: 0.8370
Epoch 6/30
154/153 [==============================] - 3969s 26s/step - loss: 0.2647 - accuracy: 0.9040 - val_loss: 0.3594 - val_accuracy: 0.8639
Epoch 7/30
154/153 [==============================] - 3970s 26s/step - loss: 0.2690 - accuracy: 0.9032 - val_loss: 0.3722 - val_accuracy: 0.8667
Epoch 8/30
154/153 [==============================] - 3968s 26s/step - loss: 0.2555 - accuracy: 0.9061 - val_loss: 0.5460 - val_accuracy: 0.8226
Epoch 9/30
154/153 [==============================] - 3982s 26s/step - loss: 0.2477 - accuracy: 0.9112 - val_loss: 0.3309 - val_accuracy: 0.8869
Epoch 10/30
154/153 [==============================] - 3971s 26s/step - loss: 0.1995 - accuracy: 0.9303 - val_loss: 0.3868 - val_accuracy: 0.8658
Epoch 11/30
154/153 [==============================] - 3979s 26s/step - loss: 0.1818 - accuracy: 0.9338 - val_loss: 0.2873 - val_accuracy: 0.8974
Epoch 12/30
154/153 [==============================] - 3995s 26s/step - loss: 0.1728 - accuracy: 0.9397 - val_loss: 0.2876 - val_accuracy: 0.8945
Epoch 13/30
154/153 [==============================] - 3971s 26s/step - loss: 0.1763 - accuracy: 0.9385 - val_loss: 0.4876 - val_accuracy: 0.8686
Epoch 14/30
154/153 [==============================] - 3971s 26s/step - loss: 0.1560 - accuracy: 0.9454 - val_loss: 0.3210 - val_accuracy: 0.9032
Epoch 15/30
154/153 [==============================] - 3987s 26s/step - loss: 0.1387 - accuracy: 0.9521 - val_loss: 0.2932 - val_accuracy: 0.9137
Epoch 16/30
154/153 [==============================] - 3971s 26s/step - loss: 0.1154 - accuracy: 0.9613 - val_loss: 0.3515 - val_accuracy: 0.8830
Epoch 17/30
154/153 [==============================] - 3968s 26s/step - loss: 0.1175 - accuracy: 0.9578 - val_loss: 0.3297 - val_accuracy: 0.8926
Epoch 18/30
154/153 [==============================] - 3983s 26s/step - loss: 0.1080 - accuracy: 0.9617 - val_loss: 0.2795 - val_accuracy: 0.9175
Epoch 19/30
154/153 [==============================] - 3972s 26s/step - loss: 0.1035 - accuracy: 0.9629 - val_loss: 0.3763 - val_accuracy: 0.8878
Epoch 20/30
154/153 [==============================] - 3973s 26s/step - loss: 0.0853 - accuracy: 0.9711 - val_loss: 0.3479 - val_accuracy: 0.9099
Epoch 21/30
154/153 [==============================] - 3972s 26s/step - loss: 0.0851 - accuracy: 0.9686 - val_loss: 0.2863 - val_accuracy: 0.9118
Epoch 22/30
154/153 [==============================] - 3986s 26s/step - loss: 0.0757 - accuracy: 0.9735 - val_loss: 0.3252 - val_accuracy: 0.9070
Epoch 23/30
154/153 [==============================] - 3970s 26s/step - loss: 0.0631 - accuracy: 0.9782 - val_loss: 0.3607 - val_accuracy: 0.9070
Epoch 24/30
154/153 [==============================] - 3977s 26s/step - loss: 0.0732 - accuracy: 0.9743 - val_loss: 0.3400 - val_accuracy: 0.9195
Epoch 25/30
154/153 [==============================] - 3971s 26s/step - loss: 0.0555 - accuracy: 0.9804 - val_loss: 0.3628 - val_accuracy: 0.9041
Epoch 26/30
154/153 [==============================] - 3990s 26s/step - loss: 0.0535 - accuracy: 0.9821 - val_loss: 0.3479 - val_accuracy: 0.9137
Epoch 27/30
154/153 [==============================] - 4013s 26s/step - loss: 0.0526 - accuracy: 0.9829 - val_loss: 0.3762 - val_accuracy: 0.9041
Epoch 28/30
154/153 [==============================] - ETA: -15s - loss: 0.0450 - accuracy: 0.9863Restoring model weights from the end of the best epoch.
154/153 [==============================] - 3978s 26s/step - loss: 0.0450 - accuracy: 0.9863 - val_loss: 0.3685 - val_accuracy: 0.9214
Epoch 00028: early stopping